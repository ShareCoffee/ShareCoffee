(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].slice;a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.CSOM=function(){function a(){}return a.getHostWeb=function(a,b){var c;return c=new SP.AppContextSite(a,b),c.get_web()},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.Commons=function(){function a(){}return a.getQueryString=function(){return document.URL.split("?")[1]},a.getQueryStringParameter=function(a){var b,c,d,e;return d=document.URL.split("?")[1].split("&"),c=function(){var c,e,f;for(f=[],c=0,e=d.length;e>c;c++)b=d[c],b.split("=")[0]===a&&f.push(b.split("=")[1]);return f}(),null!=(e=c[0])?e:""},a.getAppWebUrl=function(){var a;return null!=ShareCoffee.Commons.loadAppWebUrlFrom?ShareCoffee.Commons.loadAppWebUrlFrom():"undefined"!=typeof _spPageContextInfo&&null!==_spPageContextInfo&&null!=_spPageContextInfo.webAbsoluteUrl?_spPageContextInfo.webAbsoluteUrl:(a=ShareCoffee.Commons.getQueryStringParameter("SPAppWebUrl"),a?decodeURIComponent(a):(console&&console.error&&console.error("_spPageContextInfo is not defined"),""))},a.getHostWebUrl=function(){var a;return a=ShareCoffee.Commons.getQueryStringParameter("SPHostUrl"),null!=ShareCoffee.Commons.loadHostWebUrlFrom?ShareCoffee.Commons.loadHostWebUrlFrom():a?decodeURIComponent(a):(console&&console.error&&console.error("SPHostUrl is not defined in the QueryString"),"")},a.getApiRootUrl=function(){return""+ShareCoffee.Commons.getAppWebUrl()+"/_api/"},a.getFormDigest=function(){return document.getElementById("__REQUESTDIGEST").value},a}(),a="undefined"!=typeof global&&null!==global?global:window,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.Core=function(){function a(){}return a.checkConditions=function(a,b){if(b()===!1)throw console&&console.error&&console.error(a),a},a.getRequestInstance=function(){return"undefined"!=typeof XMLHttpRequest&&null!==XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof ActiveXObject&&null!==ActiveXObject?new ActiveXObject("MsXml2.XmlHttp"):void 0},a.loadScript=function(a,b,c){var d;return d=ShareCoffee.Core.getRequestInstance(),d.onReadyStateChange=function(){var a,e;if(4===d.readyState)if(200===d.status||304===d.status){if(a=document.getElementsByTagName("head").item(0),e=document.createElement("script"),e.language="javascript",e.type="text/javascript",e.defer=!0,e.text=d.responseText,a.appendChild(e),null!=b)return b()}else if(null!=c)return c()}},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.CrossDomainRESTFactory=function(){function a(a){this.method=a,this.SPCrossDomainLib=b(this.SPCrossDomainLib,this)}return a.prototype.SPCrossDomainLib=function(a,b,c,d,e,f){var g;if(null==b&&(b=null),null==c&&(c=null),null==d&&(d=null),null==e&&(e=null),null==f&&(f=null),ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the CrossDomain REST libraries";return"DELETE"===this.method&&(f="*"),g={url:null!=b?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppContextSite(@target)/"+a+"?@target='"+b+"'":""+ShareCoffee.Commons.getApiRootUrl()+a,method:this.method,success:c,error:d,headers:{Accept:ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"Content-Type":ShareCoffee.REST.applicationType,"X-HTTP-Method":"MERGE","If-Match":f},body:"string"==typeof e?e:JSON.stringify(e)},"GET"===this.method&&(delete g.headers["X-RequestDigest"],delete g.headers["Content-Type"]),("POST"!==this.method||null==f)&&delete g.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=f||delete g.headers["If-Match"],null==c&&delete g.success,null==d&&delete g.error,"POST"!==this.method&&delete g.body,g},a}(),a.ShareCoffee.CrossDomain=function(){function a(){}return a.crossDomainLibrariesLoaded=!1,a.loadCrossDomainLibrary=function(a,b){var c,d,e,f;return c=function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!1,b?b():void 0},e=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.Runtime.js",f=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.js",d=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.RequestExecutor.js",ShareCoffee.Core.loadScript(e,function(){return ShareCoffee.Core.loadScript(f,function(){return ShareCoffee.Core.loadScript(d,function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!0,a?a():void 0},c)},c)},c)},a.build={create:{"for":new ShareCoffee.CrossDomainRESTFactory("POST")},read:{"for":new ShareCoffee.CrossDomainRESTFactory("GET")},update:{"for":new ShareCoffee.CrossDomainRESTFactory("POST")},"delete":{"for":new ShareCoffee.CrossDomainRESTFactory("DELETE")}},a.getClientContext=function(){var a,b,c;if(ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the ClientCotext";return a=ShareCoffee.Commons.getAppWebUrl(),b=new SP.ClientContext(a),c=new SP.ProxyWebRequestExecutorFactory(a),b.set_webRequestExecutorFactory(c),b},a.getHostWeb=function(a,b){var c;if(null==b&&(b=ShareCoffee.Commons.getHostWebUrl()),ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the ClientCotext";if(null==a)throw"ClientContext cant be null, call ShareCoffee.CrossDomain.getClientContext() first";return c=new SP.AppContextSite(a,b),c.get_web()},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.RESTFactory=function(){function a(a){this.method=a,this.reqwest=b(this.reqwest,this),this.angularJS=b(this.angularJS,this),this.jQuery=b(this.jQuery,this)}return a.prototype.jQuery=function(a,b,c,d){var e;return null==b&&(b=null),null==c&&(c=null),null==d&&(d=null),"DELETE"===this.method&&(d="*"),e={url:null!=b?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppSiteContext(@target)/"+a+"?@target='"+b+"'":""+ShareCoffee.Commons.getApiRootUrl()+a,type:this.method,contentType:ShareCoffee.REST.applicationType,headers:{Accept:ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"X-HTTP-Method":"MERGE","If-Match":d},data:"string"==typeof c?c:JSON.stringify(c)},"GET"===this.method&&(delete e.contentType,delete e.headers["X-RequestDigest"]),("POST"!==this.method||null==d)&&delete e.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=d||delete e.headers["If-Match"],"POST"!==this.method&&delete e.data,e},a.prototype.angularJS=function(a,b,c,d){var e;return null==b&&(b=null),null==c&&(c=null),null==d&&(d=null),"DELETE"===this.method&&(d="*"),e={url:null!=b?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppSiteContext(@target)/"+a+"?@target='"+b+"'":""+ShareCoffee.Commons.getApiRootUrl()+a,method:this.method,headers:{Accept:ShareCoffee.REST.applicationType,"Content-Type":ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"X-HTTP-Method":"MERGE","If-Match":d},data:"string"==typeof c?c:JSON.stringify(c)},"GET"===this.method&&(delete e.headers["Content-Type"],delete e.headers["X-RequestDigest"]),("POST"!==this.method||null==d)&&delete e.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=d||delete e.headers["If-Match"],"POST"!==this.method&&delete e.data,e},a.prototype.reqwest=function(a,b,c,d){var e,f;null==b&&(b=null),null==c&&(c=null),null==d&&(d=null),"DELETE"===this.method&&(d="*"),f=null;try{f={url:null!=b?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppSiteContext(@target)/"+a+"?@target='"+b+"'":""+ShareCoffee.Commons.getApiRootUrl()+a,method:this.method.toLowerCase(),contentType:ShareCoffee.REST.applicationType,headers:{Accept:ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"If-Match":d,"X-HTTP-Method":"MERGE"},data:null!=c&&"object"==typeof c?c:JSON.parse(c)},"GET"===this.method&&(delete f.contentType,delete f.headers["X-RequestDigest"]),("POST"!==this.method||null==d)&&delete f.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=d||delete f.headers["If-Match"],"POST"!==this.method&&delete f.data}catch(g){throw e=g,"please provide either a json string or an object as payload"}return f},a}(),a.ShareCoffee.REST=function(){function a(){}return a.applicationType="application/json;odata=verbose",a.build={create:{"for":new ShareCoffee.RESTFactory("POST")},read:{"for":new ShareCoffee.RESTFactory("GET")},update:{"for":new ShareCoffee.RESTFactory("POST")},"delete":{"for":new ShareCoffee.RESTFactory("DELETE")}},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.SettingsLink=function(a,b,c){return null==c&&(c=!1),{linkUrl:c?""+a+"?"+ShareCoffee.Commons.getQueryString():a,displayName:b}},a.ShareCoffee.ChromeSettings=function(){var a,b,d,e;return b=arguments[0],e=arguments[1],a=arguments[2],d=4<=arguments.length?c.call(arguments,3):[],{appIconUrl:b,appTitle:e,appHelpPageUrl:a,settingsLinks:d}},a.ShareCoffee.UI=function(){function a(){}return a.showNotification=function(a,b){var c;return null==b&&(b=!1),c=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Notify&&null!=SP.UI.Notify.addNotification},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Notify is not defined (check if core.js is loaded)",c),SP.UI.Notify.addNotification(a,b)},a.removeNotification=function(a){var b;if(null!=a)return b=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Notify&&null!=SP.UI.Notify.removeNotification},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Notify is not defined (check if core.js is loaded)",b),SP.UI.Notify.removeNotification(a)},a.showStatus=function(a,b,c,d){var e,f;return null==c&&(c=!1),null==d&&(d="blue"),e=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.addStatus&&null!=SP.UI.Status.setStatusPriColor},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",e),f=SP.UI.Status.addStatus(a,b,c),SP.UI.Status.setStatusPriColor(f,d),f},a.removeStatus=function(a){var b;if(null!=a)return b=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.removeStatus},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",b),SP.UI.Status.removeStatus(a)},a.removeAllStatus=function(){var a;return a=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.removeAllStatus},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",a),SP.UI.Status.removeAllStatus()},a.setStatusColor=function(a,b){var c;return null==b&&(b="blue"),null!=a?(c=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.setStatusPriColor},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",c),SP.UI.Status.setStatusPriColor(a,b)):void 0},a.onChromeLoadedCallback=null,a.loadAppChrome=function(a,b,c){var d,e;return null==c&&(c=void 0),null!=c&&(ShareCoffee.UI.onChromeLoadedCallback=c,b.onCssLoaded="ShareCoffee.UI.onChromeLoadedCallback()"),d=function(){var c;return c=new SP.UI.Controls.Navigation(a,b),c.setVisible(!0)},e=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.UI.Controls.js",ShareCoffee.Core.loadScript(e,d,function(){throw"Error loading SP.UI.Controls.js"})},a}()}).call(this);