/* ShareCoffee (c) 2013 Thorsten Hans | dotnet-rocks.com | https://github.com/ThorstenHans/ShareCoffee/ | under MIT License | */(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].slice;a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.CSOM=function(){function a(){}return a.getHostWeb=function(a,b){var c;return c=new SP.AppContextSite(a,b),c.get_web()},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.Commons=function(){function a(){}return a.getQueryString=function(){return document.URL.split("?")[1]},a.getQueryStringParameter=function(a){var b,c,d,e;return d=document.URL.split("?")[1].split("&"),c=function(){var c,e,f;for(f=[],c=0,e=d.length;e>c;c++)b=d[c],b.split("=")[0]===a&&f.push(b.split("=")[1]);return f}(),null!=(e=c[0])?e:""},a.getAppWebUrl=function(){var a;return null!=ShareCoffee.Commons.loadAppWebUrlFrom?ShareCoffee.Commons.loadAppWebUrlFrom():"undefined"!=typeof _spPageContextInfo&&null!==_spPageContextInfo&&null!=_spPageContextInfo.webAbsoluteUrl?_spPageContextInfo.webAbsoluteUrl:(a=ShareCoffee.Commons.getQueryStringParameter("SPAppWebUrl"),a?decodeURIComponent(a):(console&&console.error&&console.error("_spPageContextInfo is not defined"),""))},a.getHostWebUrl=function(){var a;return null!=ShareCoffee.Commons.loadHostWebUrlFrom?ShareCoffee.Commons.loadHostWebUrlFrom():(a=ShareCoffee.Commons.getQueryStringParameter("SPHostUrl"),a?decodeURIComponent(a):(console&&console.error&&console.error("SPHostUrl is not defined in the QueryString"),""))},a.getApiRootUrl=function(){return""+ShareCoffee.Commons.getAppWebUrl()+"/_api/"},a.getFormDigest=function(){return document.getElementById("__REQUESTDIGEST").value},a}(),a="undefined"!=typeof global&&null!==global?global:window,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.Core=function(){function a(){}return a.checkConditions=function(a,b){if(b()===!1)throw console&&console.error&&console.error(a),a},a.loadScript=function(a,b,c){var d,e;return e=document.createElement("script"),d=document.getElementsByTagName("head").item(0),e.type="text/javascript",e.async=!0,e.src=a,e.onload=b,e.onerror=c,d.appendChild(e)},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.CrossDomainRESTFactory=function(){function a(a,c){this.method=a,this.updateQuery=null!=c?c:!1,this.SPCrossDomainLib=b(this.SPCrossDomainLib,this)}return a.prototype.SPCrossDomainLib=function(a){var b,c;if(null!=a&&null!=a.getRequestProperties&&(a=a.getRequestProperties()),b=new ShareCoffee.REST.RequestProperties,b.extend(a),ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the CrossDomain REST libraries";return("DELETE"===this.method||this.updateQuery===!0&&null==b.eTag)&&(b.eTag="*"),c={url:null!=b.hostWebUrl?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppContextSite(@target)/"+b.url+"?@target='"+b.hostWebUrl+"'":""+ShareCoffee.Commons.getApiRootUrl()+b.url,method:this.method,success:b.onSuccess,error:b.onError,headers:{Accept:ShareCoffee.REST.applicationType,"Content-Type":ShareCoffee.REST.applicationType,"X-HTTP-Method":"MERGE","If-Match":b.eTag},body:"string"==typeof b.payload?b.payload:JSON.stringify(b.payload)},"GET"===this.method&&(delete c.headers["X-RequestDigest"],delete c.headers["Content-Type"]),("POST"!==this.method||null==b.eTag)&&delete c.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=b.eTag||delete c.headers["If-Match"],null==b.onSuccess&&delete c.success,null==b.onError&&delete c.error,"POST"!==this.method&&delete c.body,c},a}(),a.ShareCoffee.CrossDomain=function(){function a(){}return a.crossDomainLibrariesLoaded=!1,a.loadCSOMCrossDomainLibraries=function(a,b){var c,d,e,f;return c=function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!1,b?b():void 0},e=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.Runtime.js",f=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.js",d=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.RequestExecutor.js",ShareCoffee.Core.loadScript(e,function(){return ShareCoffee.Core.loadScript(f,function(){return ShareCoffee.Core.loadScript(d,function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!0,a?a():void 0},c)},c)},c)},a.loadCrossDomainLibrary=function(a,b){var c,d;return c=function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!1,b?b():void 0},d=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.RequestExecutor.js",ShareCoffee.Core.loadScript(d,function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!0,a?a():void 0},c)},a.build={create:{"for":new ShareCoffee.CrossDomainRESTFactory("POST")},read:{"for":new ShareCoffee.CrossDomainRESTFactory("GET")},update:{"for":new ShareCoffee.CrossDomainRESTFactory("POST",!0)},"delete":{"for":new ShareCoffee.CrossDomainRESTFactory("DELETE")}},a.getClientContext=function(){var a,b,c;if(ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the ClientCotext";return a=ShareCoffee.Commons.getAppWebUrl(),b=new SP.ClientContext(a),c=new SP.ProxyWebRequestExecutorFactory(a),b.set_webRequestExecutorFactory(c),b},a.getHostWeb=function(a,b){var c;if(null==b&&(b=ShareCoffee.Commons.getHostWebUrl()),ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the ClientCotext";if(null==a)throw"ClientContext cant be null, call ShareCoffee.CrossDomain.getClientContext() first";return c=new SP.AppContextSite(a,b),c.get_web()},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.RESTFactory=function(){function a(a,c){this.method=a,this.updateQuery=null!=c?c:!1,this.reqwest=b(this.reqwest,this),this.angularJS=b(this.angularJS,this),this.jQuery=b(this.jQuery,this)}return a.prototype.jQuery=function(a){var b,c;return null!=a&&null!=a.getRequestProperties&&(a=a.getRequestProperties()),b=new ShareCoffee.REST.RequestProperties,b.extend(a),("DELETE"===this.method||this.updateQuery===!0&&null==b.eTag)&&(b.eTag="*"),c={url:b.getUrl(),type:this.method,contentType:ShareCoffee.REST.applicationType,headers:{Accept:ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"X-HTTP-Method":"MERGE","If-Match":b.eTag},data:"string"==typeof b.payload?b.payload:JSON.stringify(b.payload)},"GET"===this.method&&(delete c.contentType,delete c.headers["X-RequestDigest"]),("POST"!==this.method||null==b.eTag)&&delete c.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=b.eTag||delete c.headers["If-Match"],"POST"!==this.method&&delete c.data,c},a.prototype.angularJS=function(a){var b,c;return null!=a&&null!=a.getRequestProperties&&(a=a.getRequestProperties()),b=new ShareCoffee.REST.RequestProperties,b.extend(a),("DELETE"===this.method||this.updateQuery===!0&&null==b.eTag)&&(b.eTag="*"),c={url:b.getUrl(),method:this.method,headers:{Accept:ShareCoffee.REST.applicationType,"Content-Type":ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"X-HTTP-Method":"MERGE","If-Match":b.eTag},data:"string"==typeof b.payload?b.payload:JSON.stringify(b.payload)},"GET"===this.method&&(delete c.headers["Content-Type"],delete c.headers["X-RequestDigest"]),("POST"!==this.method||null==b.eTag)&&delete c.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=b.eTag||delete c.headers["If-Match"],"POST"!==this.method&&delete c.data,c},a.prototype.reqwest=function(a){var b,c,d;null!=a&&null!=a.getRequestProperties&&(a=a.getRequestProperties()),c=new ShareCoffee.REST.RequestProperties,c.extend(a),("DELETE"===this.method||this.updateQuery===!0&&null==c.eTag)&&(c.eTag="*"),d=null;try{d={url:c.getUrl(),type:"json",method:this.method.toLowerCase(),contentType:ShareCoffee.REST.applicationType,headers:{Accept:ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"If-Match":c.eTag,"X-HTTP-Method":"MERGE"},data:null!=c.payload&&"string"==typeof c.payload?c.payload:JSON.stringify(c.payload),success:c.onSuccess,error:c.onError},"GET"===this.method&&(delete d.contentType,delete d.headers["X-RequestDigest"]),("POST"!==this.method||null==c.eTag)&&delete d.headers["X-HTTP-Method"],"DELETE"===this.method||"POST"===this.method&&null!=c.eTag||delete d.headers["If-Match"],"POST"!==this.method&&delete d.data,null==c.onSuccess&&delete d.success,null==c.onError&&delete d.error}catch(e){throw b=e,"please provide either a json string or an object as payload"}return d},a}(),a.ShareCoffee.REST=function(){function a(){}return a.applicationType="application/json;odata=verbose",a.build={create:{"for":new ShareCoffee.RESTFactory("POST")},read:{"for":new ShareCoffee.RESTFactory("GET")},update:{"for":new ShareCoffee.RESTFactory("POST",!0)},"delete":{"for":new ShareCoffee.RESTFactory("DELETE")}},a}(),a.ShareCoffee.REST.RequestProperties=function(){function a(a,c,d,e,f,g){this.url=a,this.payload=c,this.hostWebUrl=d,this.eTag=e,this.onSuccess=f,this.onError=g,this.extend=b(this.extend,this),this.getUrl=b(this.getUrl,this),null==this.url&&(this.url=null),null==this.payload&&(this.payload=null),null==this.hostWebUrl&&(this.hostWebUrl=null),null==this.eTag&&(this.eTag=null),null==this.onSuccess&&(this.onSuccess=null),null==this.onError&&(this.onError=null)}return a.prototype.getUrl=function(){return null!=this.hostWebUrl?-1===this.url.indexOf("?")?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppContextSite(@target)/"+this.url+"?@target='"+this.hostWebUrl+"'":""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppContextSite(@target)/"+this.url+"&@target='"+this.hostWebUrl+"'":""+ShareCoffee.Commons.getApiRootUrl()+this.url},a.prototype.extend=function(){var a,b,d,e,f,g;for(d=1<=arguments.length?c.call(arguments,0):[],f=0,g=d.length;g>f;f++){b=d[f];for(a in b)e=b[a],this[a]=e}},a}(),a="undefined"!=typeof window&&null!==window?window:global,a.ShareCoffee||(a.ShareCoffee={}),a.ShareCoffee.SettingsLink=function(a,b,c){return null==c&&(c=!1),{linkUrl:c?""+a+"?"+ShareCoffee.Commons.getQueryString():a,displayName:b}},a.ShareCoffee.ChromeSettings=function(){var a,b,d,e;return b=arguments[0],e=arguments[1],a=arguments[2],d=4<=arguments.length?c.call(arguments,3):[],{appIconUrl:b,appTitle:e,appHelpPageUrl:a,settingsLinks:d}},a.ShareCoffee.UI=function(){function a(){}return a.showNotification=function(a,b){var c;return null==b&&(b=!1),c=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Notify&&null!=SP.UI.Notify.addNotification},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Notify is not defined (check if core.js is loaded)",c),SP.UI.Notify.addNotification(a,b)},a.removeNotification=function(a){var b;if(null!=a)return b=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Notify&&null!=SP.UI.Notify.removeNotification},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Notify is not defined (check if core.js is loaded)",b),SP.UI.Notify.removeNotification(a)},a.showStatus=function(a,b,c,d){var e,f;return null==c&&(c=!1),null==d&&(d="blue"),e=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.addStatus&&null!=SP.UI.Status.setStatusPriColor},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",e),f=SP.UI.Status.addStatus(a,b,c),SP.UI.Status.setStatusPriColor(f,d),f},a.removeStatus=function(a){var b;if(null!=a)return b=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.removeStatus},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",b),SP.UI.Status.removeStatus(a)},a.removeAllStatus=function(){var a;return a=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.removeAllStatus},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",a),SP.UI.Status.removeAllStatus()},a.setStatusColor=function(a,b){var c;return null==b&&(b="blue"),null!=a?(c=function(){return"undefined"!=typeof SP&&null!==SP&&null!=SP.UI&&null!=SP.UI.Status&&null!=SP.UI.Status.setStatusPriColor},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",c),SP.UI.Status.setStatusPriColor(a,b)):void 0},a.onChromeLoadedCallback=null,a.loadAppChrome=function(a,b,c){var d,e;return null==c&&(c=void 0),null!=c&&(ShareCoffee.UI.onChromeLoadedCallback=c,b.onCssLoaded="ShareCoffee.UI.onChromeLoadedCallback()"),d=function(){var c;return c=new SP.UI.Controls.Navigation(a,b),c.setVisible(!0)},e=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.UI.Controls.js",ShareCoffee.Core.loadScript(e,d,function(){throw"Error loading SP.UI.Controls.js"})},a}()}).call(this);